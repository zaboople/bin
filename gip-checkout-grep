# This really sucks and should be avoided in favor of gip-guess-branch
# just pipe the output of that to xargs git checkout


x=$(git branch | egrep "$@" | perl -pe 's/^ *//' )
if [[ $x == "" ]]; then
  git branch
  echo
  echo "Couldn't find \"$@\""
else
  lines=$(echo "$x" | wc -l | perl -pe 's/^ *//g')
  if [[ $lines != 1 ]]; then
    echo
    echo "You appear to have multiple matching branches: "
    echo "$x"
    echo
  else
    already=$( echo "$x" | perl -pe 's/^ *\*.*/*/' )
    if [[ $already == "*" ]]; then
      echo
      echo "Matched $x but you already have that checked out:"
      echo
      git branch
    else
      echo
      echo -n "Checkout $x? "
      read yn
      yn=$(echo $yn | gawk '{print tolower($0)}')
      if [[ $yn == y* ]]; then
        git checkout "$x"
      fi
    fi
  fi
fi